pipeline{
    agent any
    tools {nodejs "node"}
    environment {
        testEnvVar = "Test Value"
        TWITTER_CONSUMER_KEY = credentials('TWITTER_CONSUMER_KEY')
        TWITTER_ACCESS_TOKEN_KEY = credentials('TWITTER_ACCESS_TOKEN_KEY')
        TWITTER_ACCESS_TOKEN_SECRET = credentials('TWITTER_ACCESS_TOKEN_SECRET')
        TWITTER_BEARER_TOKEN = credentials('TWITTER_BEARER_TOKEN')
    }
    stages{
            stage('Checkout'){
                steps{
                echo 'Checking out project from git'
                checkout scm
                echo 'Checking out api keys from git'
                // checkout([
                //      $class: 'GitSCM',
                //      branches: [[name: 'main']],
                //      doGenerateSubmoduleConfigurations: false,
                //      xtensions: [[]],
                //      submoduleCfg: [],
                //      userRemoteConfigs: [[credentialsId: 'SHIKHARDEVOPSID',url: 'https://github.com/sshikhar1234/twitter-api-keys.git']]
                // ])
                git branch: 'main',
                credentialsId: 'SHIKHARDEVOPSID',
                url: 'https://github.com/sshikhar1234/twitter-api-keys.git'
                // sh 'npm install'
                }
            }
            stage('Build'){
                steps{
                echo 'Build running'
                echo "${env.testEnvVar}"
                sh 'npm start'
                }
            }
            stage('Test'){
                steps{
                echo 'Tests running'
                }
            }
            stage('Deploy'){
                steps{
                echo 'Deploying web app on cloud'
                echo 'Deployment Successful'
                }
            }
        }
    
}